"use strict";function h(t){const e=Date.now()-t.getTime(),a=new Date(e);return Math.abs(a.getUTCFullYear()-1970)}const o=t=>`nuusk-${t}`;function i(t,e=[],a=[]){const n=document.createElement(t);return typeof e=="string"&&(e=[e]),e.map(r=>r.startsWith("!")?r.replaceAll("!",""):o(r)).forEach(r=>n.classList.add(r)),typeof a=="string"?n.textContent=a:(Array.isArray(a)||(a=[a]),a.filter(r=>r instanceof HTMLElement).forEach(r=>n.appendChild(r))),n}const f=t=>t&&t.textContent||"",g="https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/b5/b5bd56c1aa4644a474a2e4972be27ef9e82e517e_full.jpg";document.querySelectorAll(".steam_player_id").forEach(t=>{const e=t.textContent?.match(/\d{6,}/)?.[0];if(!e)return;const a=t.closest(".size-1-of-2"),n=t.closest(".grid-flex")?.querySelector(".text.bold"),r=f(n),s=f(a?.querySelector("h3")),m=f(a?.querySelector(".text.standard")).replace("Yrityksen nimi:","").trim();chrome.runtime.sendMessage(e,d=>{t.insertAdjacentElement("afterend",p({...d,name:r,team:s,company:m})),t.remove(),n?.parentElement?.remove()})});function p(t){return i("div","player",[y(t),k(t)])}function y(t){const{name:e,team:a,company:n}=t;return i("div","player-header",[i("div","player-header-left",S(t)),i("div","player-header-right",[i("div","player-header-name",e??""),i("div","player-header-team",[i("strong","player-header-team-name",a??""),n&&i("span","player-header-team-company",`(${n})`)])])])}function c(t,{label:e,title:a}={}){const n=i("div","chip",[e&&i("div","chip-label",e.startsWith("fa-icon:")?i("i",e.replace("fa-icon:","").split(" ").map(r=>`!${r}`)):e),i("div","chip-value",t)]);return a&&(n.title=a),n}function k(t){const{steamId:e}=t;return i("div","player-source-cards",[u({id:"ebinstats",content:C(t),url:`https://ebinstats.kanaliiga.fi/?s=playerstats&steamID=${e}`}),u({id:"leetify",content:v(t),url:`https://beta.leetify.com/app/compare/${e}/${e}`,skip:!t.sources.leetify}),u({id:"steam",content:b(t),url:`https://steamcommunity.com/profiles/${e}`})])}function v(t){if(!t.sources.leetify)return document.createElement("div");const{ranks:e,ratings:a}=t.sources.leetify,n=e.matchmaking.highest&&e.matchmaking.highest!==e.matchmaking.current,r=e.faceit.highest&&e.faceit.highest!==e.faceit.current;return i("div","player-leetify-content",[(e.matchmaking.current||e.faceit.current)&&c(i("div","player-rank-images",[e.matchmaking.current&&l("matchmaking",e.matchmaking.current),e.faceit.current&&l("faceit",e.faceit.current)]),{title:"Current rank according to leetify, based on last ~30 matches"}),(n||r)&&c(i("div","player-rank-images",[e.matchmaking.highest&&l("matchmaking",e.matchmaking.highest),e.faceit.highest&&l("faceit",e.faceit.highest)]),{label:"Best",title:"Highest rank according to leetify, based on last ~30 matches"}),a?.leetify&&c((a?.leetify*100).toFixed(2),{label:"Rating",title:"Player Leetify rating"})])}function b({steamId:t,sources:e}){const a=e?.steam?.hours??0,n=new Date(e?.steam?.memberSince??""),r=isFinite(n.getTime())?h(n):0;return i("div","player-steam-content",[c(t,{label:"fa-icon:far fa-user",title:"SteamID64"}),a&&c(`${a}h`,{label:"fa-icon:far fa-clock",title:"Current total CS:GO hours according to Steam"}),r&&c(`${r}y`,{label:"fa-icon:far fa-cake-slice",title:"Steam account age in years"})])}function C({sources:t}){if(!t.ebinstats)return document.createElement("div");const{adr:e,kpr:a,kdr:n,kanarating:r,hours:s,rank:m}=t.ebinstats;return i("div","player-ebinstats-content",[m&&c(l("matchmaking",m),{title:"Matchmaking rank reported during season sign-up"}),e&&c(e.toString(),{label:"ADR",title:"Average Damage per Round"}),a&&c(a.toFixed(2),{label:"KPR",title:"Average Kills Per Round"}),n&&c(n.toFixed(2),{label:"KDR",title:"Total Kill/Death Ratio"}),r&&c(r.toFixed(2),{label:"Kana",title:"Average Kanarating"}),s&&c(s?`${s}h`:"N/A",{label:"fa-icon:far fa-clock",title:"CS:GO hours reported during season sign-up"})])}function u({id:t,url:e,content:a,skip:n}){if(!n)return a.classList.add(o("player-source-card-content")),i("div",["player-source-card",`player-source-${t}`],[$(t,e,"player-source-card-title"),i("div","player-source-card-container",a)])}function S({sources:t}){const e=new Image;return e.width=60,e.height=60,e.classList.add(o("player-avatar")),e.src=t?.steam?.avatar||t?.leetify?.avatar||g,e}function l(t,e){const a=new Image;return a.width=t==="matchmaking"?50:20,a.height=20,a.classList.add(o(`player-${t}-rank-image`)),e>0&&(a.src=`https://beta.leetify.com/assets/images/rank-icons/${t}${e}.png`),a}function $(t,e,a=[]){const n=document.createElement("a");return n.href=e,typeof t=="string"?n.textContent=t:n.appendChild(t),n.target="_blank",typeof a=="string"&&(a=[a]),a.map(o).forEach(r=>n.classList.add(r)),n}
