"use strict";function h(e){const t=Date.now()-e.getTime(),a=new Date(t);return Math.abs(a.getUTCFullYear()-1970)}const s=e=>`nuusk-${e}`;function i(e,t=[],a=[]){const n=document.createElement(e);return typeof t=="string"&&(t=[t]),t.map(r=>r.startsWith("!")?r.replaceAll("!",""):s(r)).forEach(r=>n.classList.add(r)),typeof a=="string"?n.textContent=a:(Array.isArray(a)||(a=[a]),a.filter(r=>r instanceof HTMLElement).forEach(r=>n.appendChild(r))),n}const u=e=>e&&e.textContent||"",g="https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/b5/b5bd56c1aa4644a474a2e4972be27ef9e82e517e_full.jpg";document.querySelectorAll(".steam_player_id").forEach(e=>{const t=e.textContent?.match(/\d{6,}/)?.[0];if(!t)return;const a=e.closest(".size-1-of-2"),n=e.closest(".grid-flex")?.querySelector(".text.bold"),r=u(n),o=u(a?.querySelector("h3")),m=u(a?.querySelector(".text.standard")).replace("Yrityksen nimi:","").trim();chrome.runtime.sendMessage(t,d=>{e.insertAdjacentElement("afterend",p({...d,name:r,team:o,company:m})),e.remove(),n?.parentElement?.remove()})});function p(e){return i("div","player",[y(e),k(e)])}function y(e){const{name:t,team:a,company:n}=e;return i("div","player-header",[i("div","player-header-left",C(e)),i("div","player-header-right",[i("div","player-header-name",t??""),i("div","player-header-team",[i("strong","player-header-team-name",a??""),n&&i("span","player-header-team-company",`(${n})`)])])])}function c(e,{label:t,title:a}={}){const n=i("div","chip",[t&&i("div","chip-label",t.startsWith("fa-icon:")?i("i",t.replace("fa-icon:","").split(" ").map(r=>`!${r}`)):t),i("div","chip-value",e)]);return a&&(n.title=a),n}function k(e){const{steamId:t}=e;return i("div","player-source-cards",[f({id:"ebinstats",content:S(e),url:`https://ebinstats.kanaliiga.fi/?s=playerstats&steamID=${t}`,skip:!e.sources.ebinstats}),f({id:"leetify",content:v(e),url:`https://beta.leetify.com/app/compare/${t}/${t}`,skip:!e.sources.leetify}),f({id:"steam",content:b(e),url:`https://steamcommunity.com/profiles/${t}`})])}function v(e){if(!e.sources.leetify)return document.createElement("div");const{ranks:t,ratings:a}=e.sources.leetify,n=t.matchmaking.highest&&t.matchmaking.highest!==t.matchmaking.current,r=t.faceit.highest&&t.faceit.highest!==t.faceit.current;return i("div","player-leetify-content",[(t.matchmaking.current||t.faceit.current)&&c(i("div","player-rank-images",[t.matchmaking.current&&l("matchmaking",t.matchmaking.current),t.faceit.current&&l("faceit",t.faceit.current)]),{title:"Current rank according to leetify, based on last ~30 matches"}),(n||r)&&c(i("div","player-rank-images",[t.matchmaking.highest&&l("matchmaking",t.matchmaking.highest),t.faceit.highest&&l("faceit",t.faceit.highest)]),{label:"Best",title:"Highest rank according to leetify, based on last ~30 matches"}),a?.leetify&&c((a?.leetify*100).toFixed(2),{label:"Rating",title:"Player Leetify rating"})])}function b({steamId:e,sources:t}){const a=t?.steam?.hours??0,n=new Date(t?.steam?.memberSince??""),r=isFinite(n.getTime())?h(n):0;return i("div","player-steam-content",[c(e,{label:"fa-icon:far fa-user",title:"SteamID64"}),a&&c(`${a}h`,{label:"fa-icon:far fa-clock",title:"Current total CS:GO hours according to Steam"}),r&&c(`${r}y`,{label:"fa-icon:far fa-cake-slice",title:"Steam account age in years"})])}function S({sources:e}){if(!e.ebinstats)return document.createElement("div");const{adr:t,kpr:a,kdr:n,kanarating:r,hours:o,rank:m}=e.ebinstats;return i("div","player-ebinstats-content",[m&&c(l("matchmaking",m),{title:"Matchmaking rank reported during season sign-up"}),t&&c(t.toString(),{label:"ADR",title:"Average Damage per Round"}),a&&c(a.toFixed(2),{label:"KPR",title:"Average Kills Per Round"}),n&&c(n.toFixed(2),{label:"KDR",title:"Total Kill/Death Ratio"}),r&&c(r.toFixed(2),{label:"Kana",title:"Average Kanarating"}),o&&c(o?`${o}h`:"N/A",{label:"fa-icon:far fa-clock",title:"CS:GO hours reported during season sign-up"})])}function f({id:e,url:t,content:a,skip:n}){if(!n)return a.classList.add(s("player-source-card-content")),i("div",["player-source-card",`player-source-${e}`],[E(e,t,"player-source-card-title"),i("div","player-source-card-container",a)])}function C({sources:e}){const t=new Image;return t.width=60,t.height=60,t.classList.add(s("player-avatar")),t.src=e?.steam?.avatar||e?.leetify?.avatar||g,t}function R(e){return e<5e3?0:e<1e4?1:e<15e3?2:e<2e4?3:e<25e3?4:e<3e4?5:6}function l(e,t){return e==="matchmaking"&&t>18?$(t):M(e,t)}function $(e){const t=R(e),a=new Image;a.width=50,a.height=20,a.classList.add(s("player-mmr-image")),a.src=`https://beta.leetify.com/assets/images/rank-icons/cs_rating_${t}.svg`;const n=Math.floor(e/1e3).toString(),r=e.toString().substring(e.toString().length-3);return i("div","player-mmr",[a,i("div",["player-mmr-value",`cs-rating-tier-${t}`],[i("span","player-mmr-value-thousands",`${n.padStart(2," ")},`),i("span","player-mmr-value-hundreds",r)])])}function M(e,t){const a=new Image;return a.width=e==="matchmaking"?50:20,a.height=20,a.classList.add(s(`player-${e}-rank-image`)),t>0&&(a.src=`https://beta.leetify.com/assets/images/rank-icons/${e}${t}.png`),a}function E(e,t,a=[]){const n=document.createElement("a");return n.href=t,typeof e=="string"?n.textContent=e:n.appendChild(e),n.target="_blank",typeof a=="string"&&(a=[a]),a.map(s).forEach(r=>n.classList.add(r)),n}
